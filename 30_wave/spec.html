<!DOCTYPE html>

<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta name="description" content="[spec]演奏の設定">
  <meta name="author" content="online-simulator.github.io">
  <noscript>JavaScript is not enabled on browser.</noscript>
  <link rel="stylesheet" type="text/css" href="../00_common/css/common.css">
  <link rel="stylesheet" type="text/css" href="../00_common/css/color.css">
  <link rel="stylesheet" type="text/css" href="../00_common/css/size.css">
  <link rel="stylesheet" type="text/css" href="css/common.css">
  <link rel="stylesheet" type="text/css" href="css/color.css">
  <link rel="stylesheet" type="text/css" href="css/size.css">
</head>

<body>
  <div class="absolute">
    <table class="border">
      <caption><span id="span-history">演奏機能の更新履歴</span></caption>
      <tbody>
        <tr class="border">
          <td class="border clear">
Ver.1.80.15
          </td>
          <td class="border">
・Ver.1.80.14の不備（overtoneなしの位相初期化の不具合）を修正
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.80.14
          </td>
          <td class="border">
・overtoneを更新
<br>
　各音階の自然なgain調整の演算を追加
<br>
　各音階の位相初期値を更新（mod 5-1の演算）
<br>
・testcase-Yuyake_Koyake/_overtoneを更新（type/g1を削除・overtone=4　⇒　5）
<br>
・testcase-Auld_Lang_Syne/_overtoneを更新（type/f0/g0/f1/g1を削除・overtone=3　⇒　5）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.79.14
          </td>
          <td class="border">
・testcase-Auld_Lang_Syne_overtoneを更新（overtone=4　⇒　3）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.78.14
          </td>
          <td class="border">
・testcase-tableを更新（$typedef1を追加）
<br>
<del>・testcase-Auld_Lang_Syne/_overtoneを更新
<br>
　f0/g0/f1/g1：調整後　⇒　調整前
<br>
・testcase-Auld_Lang_Syne_overtone2を追加
<br>
　f0/g0/f1/g1：調整後
<br>
・?testcase link-Auld_Lang_Syne-overtone-2を追加</del>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.77.14
          </td>
          <td class="border">
・output_wave.jsを更新（glissandoの各音階gainの過小評価を改善）
<br>
・testcase-glissando1/_duty0/glissando2を更新
<br>
　amplitude0=2　⇒　amplitude1=0.5
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.76.14
          </td>
          <td class="border">
・testcase-Auld_Lang_Syne/_overtoneを追加
<br>
　f0/g0/f1/g1を調整（filter gainで1/fゆらぎを調整）
<br>
・?testcase link-Auld_Lang_Syne/-overtoneを追加
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.75.14
          </td>
          <td class="border">
・input-amplitude（kampli）の仕様修正
<br>
　kampliとamplitude0/amplitude1：従属　⇒　独立
<br>
・handler_wave_worker_sw2.jsを更新
<br>
・output_wave.jsを更新
<br>
・?testcase link-glissando1/glissando2を調整
<br>
・?testcase link-glissando1-duty0/-echoを追加
<br>
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新
<br>
　glissando1~2を追加
<br>
　overtone1~3を調整
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.74.14
          </td>
          <td class="border">
・拡張datasetにti/toの項目を追加
<br>
・?testcase link-glissando1/glissando2を追加
<br>
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.73.14
          </td>
          <td class="border">
・handler_wave_worker_sw2.jsを整理
<br>
　self.str2sec()を追加
<br>
　self.str2freq()を追加
<br>
　self.str2arr_f()を追加
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.72.14
          </td>
          <td class="border">
・testcase-Yuyake_Koyakeのscriptを調整（出力の変更なし）
<br>
・testcase-*_overtoneを更新
<br>
　s_stereo：100　⇒　75
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.71.14
          </td>
          <td class="border">
・dataset-typeを拡張（任意波形tableの線形補間に対応）
<br>
　format修正：type=x0,x1,...xn:y0,y1,...yn　⇒　type=[x0,x1,...xn:y0,y1,...yn]
<br>
　基本dataset:通常formatに対応
<br>
・拡張datasetを更新（重複定義のerror終了処理を追加）
<br>
・wave-typeを更新
<br>
　sawsmooth/sawsmooth_randを追加
<br>
・testcase-tableを追加
<br>
・?testcase link-tableを追加
<br>
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新
<br>
　table1~3を追加
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.70.14
          </td>
          <td class="border">
・script-Verを追加
<br>
　Ver.1：後方互換性を担保
<br>
　Ver.2：基本dataset:通常formatの仕様変更
<br>
・拡張datasetを更新
<br>
　command単体で実行可
<br>
　代入formatを列挙して実行可（項目数の制限なし）
<br>
・?testcase linkを一括更新（script-Ver.2用）
<br>
　testcase-1を調整（clear;の使用例）
<br>
　testcase-Froschgesang_echo/_overtoneを修正（$e1/$e2を適用）
<br>
　一括調整：$1; r;　⇒　r; $1;
<br>
・tVer@URL-parameterを追加
<br>
・testcase-Yuyake_Koyakeを更新（overtoneなしを追加）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.69.14
          </td>
          <td class="border">
・handler_wave.js/handler_wave_worker_sw2.jsを整理（dataset定義の仕様変更の準備）
<br>
・代入formatのerror終了処理を改善
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.68.14
          </td>
          <td class="border">
・file nameを更新（任意名を入力可）
<br>
　要素：span　⇒　input
<br>
　拡張子：あり　⇒　なし
<br>
　auto checked時、後方互換性あり
<br>
　固有名詞を含むtestcaseの場合、auto非表示
<br>
・testcase-Yuyake_Koyakeを追加
<br>
　$commonを修正：p1=0　⇒　削除
<br>
　余韻の調整：$lastを追加
<br>
　$commonを変更：type無指定　⇒　type=1
<br>
　作詞／作曲の順番を訂正：曲先　⇒　詩先
<br>
　$chord1~3の音の長さを修正（引用を明記）
<br>
　$sheetを一旦、削除（command不足）
<br>
・?testcase link-Yuyake_Koyakeを追加
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.67.14
          </td>
          <td class="border">
・overtoneを更新
<br>
　倍音のgainを厳密化（音質の劣化を改善：max係数の目安≒7.15　⇒　6.15）
<br>
・testcase-duty0/duty1を更新（order_dを調整）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.66.14
          </td>
          <td class="border">
・old-weightを更新（default：0.005　⇒　0）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.65.14
          </td>
          <td class="border">
・datasetを拡張（代入formatを追加）
<br>
・dataset不正のerror終了処理を追加
<br>
・testcase-duty0/duty1を追加
<br>
・?testcase link-beep3以降を更新（macro定義の一部を代入formatに変更）
<br>
・?testcase link-0/duty0/duty1/1を追加
<br>
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新（代入formatを追記）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.64.14
          </td>
          <td class="border">
・overtoneを追加（基音より高周波数の倍音を自動付与）
<br>
　select-0~12　⇒　input-0~24
<br>
　単音/和音pageのamplitudeの内部limiterを解除・max係数の目安を改善
<br>
・拡張datasetにovertoneの項目を追加
<br>
・?testcase link-overtoneを追加
<br>
・?testcase link-beep3を更新
<br>
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新
<br>
　beep3を変更
<br>
　chord2を追加
<br>
　overtone1~3を追加
<br>
・handler_wave.jsを更新
<br>
　$.inputVal_id()　⇒　$.inputNum_id()
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.63.14
          </td>
          <td class="border">
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新
<br>
　sweep1~3を追加
<br>
　play9~11 with vibratoを削除
<br>
　vibrato1~3を追加
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.62.14
          </td>
          <td class="border">
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>-beep1/beep2のdatasetを修正（testcaseに準拠）
<br>
　rate=-2　⇒　2^-2=0.25
<br>
　order=2　⇒　2^2=4
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.62.13
          </td>
          <td class="border">
・<a title="wave plot" href="../31_wave_plot/index.html">wave plot</a>から<a title="[spec]wave plot" href="../31_wave_plot/spec.html">[spec]wave plot</a>のpageを分離
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.61.13
          </td>
          <td class="border">
・random-buttonを追加（test case用）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.60.13
          </td>
          <td class="border">
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新（dataset列を追加・beep3を追加）
<br>
・?testcase link-beep3を追加
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.59.13
          </td>
          <td class="border">
・file size制限の不具合を再修正（check時のみ、params.number_samplesが未反映の状態を修正）
<br>
　self.update_number_samples()のcall箇所：self.waveo.init()直前とplay直前　⇒　self.waveo.init()直後
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.59.12
          </td>
          <td class="border">
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新（chordを追加）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.58.12
          </td>
          <td class="border">
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新（default/beep1/beep2/play with vibratoを追加）
<br>
　厳密なJSONを記述するtextareaに変更（任意の周波数で無音の場合、gainの要調整）
<br>
　JSON項目の列挙順を変更（拡張datasetに準拠）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.57.12
          </td>
          <td class="border">
・f_vibrato[Hz]を追加
<br>
　f_vib=-10~10　⇒　無制限（着信音の場合、10~15[Hz]）
<br>
・?testcase link-beep1/beep2を追加（各種機能の結合test用）
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.56.12
          </td>
          <td class="border">
・sweep中の位相の連続性を改善（dataset内で位相の前回値を継承）
<br>
　f_vib=-3~3　⇒　-10~10
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.56.11
          </td>
          <td class="border">
・拡張datasetにf_vibの項目を追加（vibratoを模擬）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.55.11
          </td>
          <td class="border">
・?testcase link-echoを追加（長いdelay成分の反響を模擬）
<br>
・spec追記
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.54.11
          </td>
          <td class="border">
・?testcase link-100sの追加表示
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.53.11
          </td>
          <td class="border">
・並列処理の最適なNthread既定値を自動選択
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.52.11
          </td>
          <td class="border">
・script入力のみ、BPMを追加（tempoに自動変換）
<br>
・script入力のみ、Δf[Hz]に=4/tempoのcheckboxを追加
<br>
・tempo入力欄のtime演算表示の位置を調整（time*　⇒　*time）
<br>
・Δfの定義の一部を削除して訂正
<br>
　1/fゆらぎ（spectrum強度∝1/fの関係）と区別
<br>
・testcaseを更新
<br>
　tempo=0.5　⇒　0.5172413793103449（体内時計の116BPM：月に同調のtempo）
<br>
　Δf[Hz]=10　⇒　4/tempo=7.73...（θ～α脳波の周波数：地球の固有振動数||放射線帯基準peak付近）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.51.11
          </td>
          <td class="border">
・<a title="[test]wave plot" href="../31_wave_plot/index.html">[test]wave plot</a>を更新
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.50.11
          </td>
          <td class="border">
・sample数/secを更新
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.49.11
          </td>
          <td class="border">
・fade-orderを更新（cosを追加）
<br>
　script入力値：order_fade=3
<br>
　UI選択値：cos
<br>
・handler_baseview.jsを整理
<br>
・<a title="[test]wave plot" href="../31_wave_plot/index.html">[test]wave plot</a>を更新
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.48.11
          </td>
          <td class="border">
・高音質のint24に対応（3Byte数/sampleを追加）
<br>
・handler_baseview.jsを更新（<a title="[memo]BE/LE指定の実装方法" href="../74_base64/BELE.html">DataView</a>非対応のint24は文字列操作で実装）
<br>
・<a title="[test]wave plot" href="../31_wave_plot/index.html">[test]wave plot</a>を更新
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.47.11
          </td>
          <td class="border">
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>を更新
<br>
　check_limit(params)を統廃合
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.46.11
          </td>
          <td class="border">
・超高音質のint32に対応（4Byte数/sampleを追加）
<br>
・<a title="[test]wave plot" href="../31_wave_plot/index.html">[test]wave plot</a>を更新
<br>
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>の動作を正常化
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.45.11
          </td>
          <td class="border">
・script入力のみ、amplitudeにauto-maxのcheckboxを追加
<br>
　post処理で振幅を最大化する自動scaling（scale比大で波形の劣化あり）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.44.11
          </td>
          <td class="border">
・scriptのdatasetの最小単位を更新（時間を省略時、1beatの指定周波数に変換）
<br>
　{r; 0; 440; [440,880];} -> {b:r; b:0; b:440; b:[440,880];}
<br>
・testcaseを更新
<br>
・testcaseのmacro定義のspellを訂正
<br>
　code　⇒　chord
<br>
・sourceの変数名を修正
<br>
　(octave, code)　⇒　(octave, note)
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.43.11
          </td>
          <td class="border">
・macro定義のtagの正規表現に空白||改行文字を追加
<br>
　ES6対応環境のみ、spacingを保持してtext置換可
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.42.11
          </td>
          <td class="border">
・macro定義のdatasetの正規表現にminus-とplus+を追加
<br>
　数値の符号入力||指数表記に対応
<br>
　datasetのorder_fade||oc記法を正常化
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.42.10
          </td>
          <td class="border">
・original scriptのmacro残存の場合、error終了に変更
<br>
・macro定義のtagの正規表現にunderscore_とhyphen-を追加
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.41.10
          </td>
          <td class="border">
・amplitudeのint値over-flow@stream処理の場合、error終了に修正（Ver.1.40.9の追加修正）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.41.9
          </td>
          <td class="border">
・macro機能を追加（入力textの前方からmacro定義順に{}内のtext置換）
<br>
・original script出力欄を追加（text置換結果の確認用）
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.40.9
          </td>
          <td class="border">
・amplitudeのint値over-flow@post処理の場合、error終了に修正
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.40.8
          </td>
          <td class="border">
・<span class="clear">fade-rangeのp0/p1の仕様変更</span>
<br>
　割合指定　⇒　時間[sec]指定（単音等、datasetのtime[msec]=1000の場合、同義）
<br>
・fade-orderを更新
<br>
・従来の各設定値を変更
<br>
　script入力値：order_fade=-1 || -2
<br>
　UI選択値：old1 || old2
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.39.8
          </td>
          <td class="border">
・fade-orderを更新
<br>
　order_fade=1の曲線近似を追加
<br>
・従来の重み平均処理の設定値を変更
<br>
　script入力値：order_fade=0
<br>
　UI選択値：1.
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.38.8
          </td>
          <td class="border">
・fade-orderを追加
<br>
・fade-order=2でp0/p1既定値を調整
<br>
・testcaseを更新
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.37.8
          </td>
          <td class="border">
・ゆらぎありΔf≠0@s_stereo&lt;100でchannel間の合成の不具合（stereo出力が左右反転）を修正
<br>
　newVal0 = (1-s)*val0+s*val1　⇒　newVal0 = s*val0+(1-s)*val1
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.37.7
          </td>
          <td class="border">
・<a title="[test]wave plot" href="../31_wave_plot/index.html">[test]wave plot</a>のpageを追加（出力int値の確認用）
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.36.7
          </td>
          <td class="border">
・ゆらぎありΔf≠0でmonaural低音質出力の不具合（int値のoffset未考慮）を修正
<br>
　val1 = 0　⇒　val1 = val_offset
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.35.6
          </td>
          <td class="border">
・script入力のみ、amplitudeの上限解放（int値over-flowの場合、pulse波のnoise発生）
<br>
　play実行後、amplitude上限値の目安を表示
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.34.6
          </td>
          <td class="border">
・wave-typeを更新
<br>
　sawtoothrev/sawtooth0/sawtooth0revを追加
<br>
　各type_randを追加（位相初期値に乱数を付与）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.33.6
          </td>
          <td class="border">
・ゆらぎ周波数Δfの他channel合成率s_stereoを追加
<br>
・testcaseを更新
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.32.6
          </td>
          <td class="border">
・ゆらぎ周波数Δfのばらつき強度s_randomを追加
<br>
・Δfのmonaural出力に対応
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.31.6
          </td>
          <td class="border">
・duty||amplitudeの変化率のorderを追加（script限定）
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.30.6
          </td>
          <td class="border">
・square||sawtoothの波形を選択時、休止||f=0の間にnoise発生の不具合を修正
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.30.5
          </td>
          <td class="border">
・file size制限の不具合を修正（limiter機能を正常化）
<br>
・file sizeの上限up
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.30.4
          </td>
          <td class="border">
・本pageを分離して独立化
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.29.4
          </td>
          <td class="border">
・stereo効果のゆらぎ周波数Δfを追加
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.28.4
          </td>
          <td class="border">
・<span class="clear">amplitudeの仕様変更（tempo||pitchに準拠）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.27.4
          </td>
          <td class="border">
・<span class="wF">testcase@URL-parameterを追加</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.26.4
          </td>
          <td class="border">
・<span class="jF">sweep-orderを追加</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.25.4
          </td>
          <td class="border">
・<span class="jF">sweep-rateを更新（filter gain適用）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.24.4
          </td>
          <td class="border">
・<span class="jF">sweep-rateを追加（filter gain固定）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.20.4
          </td>
          <td class="border">
・<span class="condition">datasetを拡張</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.19.4
          </td>
          <td class="border">
・<span class="condition">"f"+周波数入力の小数点以下を有効化</span>
<br>
・時間の入力形式を拡張（60BPM基準の演算子b=1000msecを定義）
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.18.4
          </td>
          <td class="border">
・binary生値fade-in/out機能raw-value fadeを復帰
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.17.4
          </td>
          <td class="border">
・tempo/pitch/amplitudeの設定項目を追加
<br>
・fade-in/outの設定項目を拡張
<br>
・<span class="clear">time=0の場合、error終了に仕様変更</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.16.4
          </td>
          <td class="border">
・wave-dutyの設定項目を追加
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.15.4
          </td>
          <td class="border">
・<span class="run">scientific pitch記法に対応</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.14.4
          </td>
          <td class="border">
・frequency checkerを追加
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.13.4
          </td>
          <td class="border">
・88鍵盤標準の<span class="clear">scientific pitch記法に準拠</span>
<br>
・MIDI-octave数に負数を指定できない致命的な不具合を修正
          </td>
        </tr>
        <tr class="border">
          <td class="border clear">
Ver.1.13.3
          </td>
          <td class="border">
・pitchに影響する生値fade-in/out　⇒　物理的な振幅fade-in/outに修正
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.13.2
          </td>
          <td class="border">
・parallel Multi-threadingに対応
          </td>
        </tr>
        <tr class="border">
          <td class="border run">
Ver.1.4.2
          </td>
          <td class="border">
・生値fade-in/outを追加
          </td>
        </tr>
      </tbody>
    </table>
<br>
    <table class="border">
      <caption>scriptの入力形式</caption>
      <thead>
        <tr class="border">
          <th class="border">
項目
          </th>
          <th class="border">
内容
          </th>
          <th class="border">
実装
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="border">
          <td class="border">
macro機能
<br>
<span class="run">Ver.1.41.9追加</span>
<br>
<span class="jF">Ver.1.42.10追加</span>
<br>
<span class="clear">Ver.1.42.11追加</span>
<br>
<span class="wF">Ver.1.43.11追加</span>
<br>
<span class="wF">Ver.1.65.14追加</span>
          </td>
          <td class="border">
{}外に定義
          </td>
          <td class="border">
<span id="span-macro"></span>
入力textの前方からmacro定義順に{}内のtext置換
<br>
・macro定義のformat：$<span class="condition">[0-9a-zA-Z<span class="jF">_-</span>]+</span>(<span class="selection">[0-9a-zA-Z<span class="jF">_-<span class="clear">+</span><span class="wF">=</span></span>.,:;[]$<span class="wF">\s</span>]+</span>)
<br>
　0-9a-zA-Z<span class="jF">_</span>部分は\wで短縮可
<br>
・置換内容：{<span class="condition">$tag</span>; -> <span class="selection">dataset||chordset</span>;}
<br>
　区切り文字;を残す方が間違いが少ない
<br>
　<span class="wF">ES6対応環境のみ、spacingを保持してtext置換可</span>
<br>
・macroをnestingする場合、chordsetの単位chordを入力textの後方に定義
<br>
$chordsets($chordset;$chordset)
<br>
$chordset($chord;$chord)
<br>
$chord(:$C;:$D;:$E)
<br>
$C([C4,C5,C6])$D([D4,D5,D6])$E([E4,E5,E6])
<br>
<br>
macro定義の厳密な正規表現を確認する場合、<a title="正規表現text置換" href="../71_regexp/index.html?testcase=wave">正規表現text置換</a>参照
<br>
・$tagから空文字を含む任意の文字列にmacro置換実行可
<br>
　<span class="wF">ES6対応環境のみ、空白||改行文字を保持</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
channel
          </td>
          <td class="border">
時系列の音dataを出力
          </td>
          <td class="border">
stream処理：channel内の合成（binary出力）
<br>
post処理：channel間の合成（binary入出力）
          </td>
        </tr>
        <tr class="border">
          <td class="border">
channelの区別
          </td>
          <td class="border">
{}
          </td>
          <td class="border">
channelの区切り文字（半角の波括弧）
          </td>
        </tr>
        <tr class="border">
          <td class="border" rowspan="3">
          </td>
          <td class="border">
channel番号=1~
          </td>
          <td class="border">
入力textの前方から昇順に番号を付与
          </td>
        </tr>
        <tr class="border">
          <td class="border">
channel間の合成
<br>
<span class="clear">Ver.1.37.8修正</span>
          </td>
          <td class="border">
奇数番channel：channel1に合成
<br>
偶数番channel：channel2||1に合成（channel数に依存）
<br>
Δf≠0：channel1とchannel2を合成<span class="clear">（stereo出力が左右反転する不具合を修正）</span>
<br>
<br>
binary出力順：channel1 -> channel2
          </td>
        </tr>
        <tr class="border">
          <td class="border">
入力例
<br>
<span class="run">Ver.1.44.11更新</span>
          </td>
          <td class="border">
<del>{r} || {0} || </del>{} || {}{} || {}{}{} -> error終了（時間指定なし）
<br>
<span class="run">{r}</span> || <span class="run">{0}</span> || {:}{} || {:} || {b:0} -> 保存可能（1beatの無音）
<br>
<span class="run">{r; 0; 440; [440,880];} -> {b:r; b:0; b:440; b:[440,880];}</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
dataset
<br>
<span class="clear">Ver.1.30.6対応</span>
<br>
<span class="run">Ver.1.44.11更新</span>
<br>
<span class="selection">Ver.1.65.14更新</span>
          </td>
          <td class="border">
音dataの単位
          </td>
          <td class="border">
<span class="selection">基本dataset
<br>
・値不正のerror終了処理を追加</span>
<br>
<br>
<span class="run">音階;</span>
<br>
時間:音階;
<br>
時間:[音階0,音階1,...];
<br>
時間:r;
<br>
<span class="clear">休止時間:0;</span>
<br>
<br>
要素省略時：1beatの休止（b:0に同義）
<br>
<span class="run">・時間省略時：1beat</span>
<br>
<span class="run">・音階省略時：r||0</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border" rowspan="4">
<span class="condition">Ver.1.55.11追記</span>
<br>
<span class="jF">Ver.1.67.14追記</span>
          </td>
          <td class="border">
:
          </td>
          <td class="border">
dataset要素の区切り文字（半角のcolon）
          </td>
        </tr>
        <tr class="border">
          <td class="border">
;
          </td>
          <td class="border">
datasetの区切り文字（半角のsemi-colon）
<br>
<span class="condition">・dataset間の直接音の残響と反響（空間の反射成分）は未考慮</span>
<br>
<span class="jF">・dataset間のlegato（なめらかに）：現状、複数のchannelで音の重なり部分を調整</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
[,]
          </td>
          <td class="border">
音階列挙の区切り文字（半角の角括弧）
<br>
音階の区切り文字（半角のcomma）
          </td>
        </tr>
        <tr class="border">
          <td class="border">
r
<br>
<span class="selection">Ver.1.65.14更新</span>
          </td>
          <td class="border">
休止記号（半角のr）
<br>
<span class="selection">・正規表現を厳密化：^r　⇒　^r$</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border" rowspan="2">
拡張dataset
<br>
<span class="condition">Ver.1.20.4追加</span>
<br>
<span class="jF">Ver.1.24.4追加</span>
<br>
<span class="jF">Ver.1.26.4追加</span>
<br>
<span class="selection">Ver.1.31.6追加</span>
<br>
<span class="selection">Ver.1.35.6更新</span>
<br>
<span class="wF">Ver.1.38.8追加</span>
<br>
<span class="wF">Ver.1.39.8更新</span>
<br>
<span class="wF">Ver.1.40.8更新</span>
<br>
<span class="wF">Ver.1.49.11更新</span>
<br>
<span class="wF">Ver.1.56.11更新</span>
<br>
<span class="wF">Ver.1.56.12更新</span>
<br>
<span class="wF">Ver.1.57.12更新</span>
<br>
<span class="wF">Ver.1.64.14更新</span>
<br>
<span class="wF">Ver.1.71.14更新</span>
<br>
<span class="wF">Ver.1.74.14更新</span>
          </td>
          <td class="border">
通常format
<br>
<span class="run">Ver.1.65.14更新</span>
<br>
<span class="jF">Ver.1.71.14更新</span>
<br>
<span class="wF">Ver.1.75.14更新</span>
          </td>
          <td class="border">
拡張設定値を列挙
<br>
<span class="run">・値不正のerror終了処理を追加</span>
<br>
<span class="jF">・重複定義のerror終了処理を追加（代入formatを含む）</span>
<br>
<br>
<span class="run">音階;</span>
<br>
時間:音階
<br>
時間:[音階0,音階1,...]
<br>
時間:r
<br>
<span class="clear">休止時間:0</span>
<br>
<span class="condition">:command=""||"clear"</span>
<br>
<span class="condition">:type=0~<span class="wF">13</span>:duty0=0~1:duty1=0~1:amplitude0=<span class="selection">0~<del>1</del></span>:amplitude1=<span class="selection">0~<del>1</del></span></span>
<br>
<span class="condition">:w0=0~1:p0=0~1:w1=0~1:p1=0~1:f0:g0=0~1:f1:g1=0~1</span>
<br>
<span class="jF">:rate=0~:order=0~</span><span class="selection">:order_d=0~:order_a=0~</span>
<br>
<span class="wF">:order_fade=floor(-2~3):f_vib:overtone=floor(0~24):ti=0~:to=0~</span>;
<br>
<br>
<span class="wF">
script入力のみ対応の項目
<br>
・order_d/order_a
<br>
・ti/to
</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
代入format
<br>
<span class="run">Ver.1.65.14追加</span>
<br>
<span class="clear">Ver.1.69.14更新</span>
<br>
<span class="condition">Ver.1.70.14更新</span>
<br>
<span class="jF">Ver.1.71.14更新</span>
          </td>
          <td class="border">
拡張設定項目=拡張設定値を列挙
<br>
b:A4:clear:1:0.5::::::::::::::::::5
<br>
b:A4:clear:1:0.5:overtone=5
<br>
b:A4:clear:1:duty0=0.5:overtone=5
<br>
b:A4:clear:duty0=0.5:type=1:overtone=5
<br>
・拡張設定項目のみ、指定可（順不同）
<br>
・重複定義の場合、<span class="jF"><del>代入formatの左から順次上書き</del>error終了</span>
<br>
・構文不正（項目名のspellを含む）の場合、error終了
<br>
・値不正の場合、error終了
<br>
<span class="clear">・複数の代入記号=が存在する場合、error終了</span>
<br>
<span class="condition">・代入formatを列挙して実行可（項目数の制限なし）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
拡張設定項目
<br>
<span class="run">Ver.1.70.14追加</span>
          </td>
          <td class="border">
type以降の設定項目
          </td>
          <td class="border">
基本dataset:通常formatの仕様
<br>
・script-Ver.1：直前datasetの拡張設定値を継承（後方互換性を担保）
<br>
・script-Ver.2：dataset内のみ拡張設定値が有効
          </td>
        </tr>
        <tr class="border">
          <td class="border" rowspan="5">
          </td>
          <td class="border">
<span class="condition">command</span>
<br>
<span class="selection">Ver.1.65.14更新</span>
<br>
<span class="condition">Ver.1.70.14更新</span>
          </td>
          <td class="border">
省略時：直前datasetの拡張設定値を継承||clear状態でUI設定値を参照
<br>
clear：直前datasetの拡張設定値をclear
<br>
<span class="selection">・command不正のerror終了処理を追加</span>
<br>
<span class="condition">・command単体で実行可</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="condition">type</span>
<br>
<span class="run">Ver.1.34.6更新</span>
<br>
<span class="jF">Ver.1.71.14更新</span>
          </td>
          <td class="border">
波形の種類
<br>
0：sin
<br>
1：triangle
<br>
2：square
<br>
3：sawtooth
<br>
<span class="run">4：sawtoothrev</span>
<br>
<span class="run">5：sawtooth0</span>
<br>
<span class="run">6：sawtooth0rev</span>
<br>
<span class="run">7：sin_rand</span>
<br>
<span class="run">8：triangle_rand</span>
<br>
<span class="run">9：square_rand</span>
<br>
<span class="run">10：sawtooth_rand</span>
<br>
<span class="run">11：sawtoothrev_rand</span>
<br>
<span class="jF">12：sawsmooth</span>
<br>
<span class="jF">13：sawsmooth_rand</span>
<br>
<br>
<span class="jF">任意波形tableの線形補間に対応
<br>
・tableのformat：type=[x0,x1,...xn:y0,y1,...yn]
<br>
<del>・基本dataset:通常formatの場合、非対応（error終了）</del>
<br>
・x範囲=[0,1]
<br>
・y範囲=[-1,1]
<br>
・x前提：昇順sort済み</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="condition">
duty0
<br>
duty1
</span>
<br>
<span class="selection">order_d</span>=1@default
          </td>
          <td class="border">
N個中n番目sampleのduty比
<br>
=duty0+(duty1-duty0)*pow(n/N,<span class="selection">order_d</span>)
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="condition">
amplitude0
<br>
amplitude1
</span>
<br>
<span class="selection">order_a</span>=1@default
          </td>
          <td class="border">
N個中n番目sampleの振幅の<span class="clear">比例係数</span>
<br>
=amplitude0+(amplitude1-amplitude0)*pow(n/N,<span class="selection">order_a</span>)
          </td>
        </tr>
        <tr class="border">
          <td class="border" rowspan="2">
<span class="condition">
w0
<br>
p0
<br>
w1
<br>
p1
</span>
          </td>
          <td class="border">
振幅fade-in/outのfilter特性値
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="condition">dataset間の連続条件</span>
          </td>
          <td class="border">
w0=0
<br>
w1=0
<br>
((時間*1e3*tempo)%(1000*1e3/周波数))%1=0
<br>
:[1000]:::0:0.5:0:1:0:0:0:0;:[1000]:::0.5:0.5:1:1;:[1000]:::0.5:1:1:0;
          </td>
        </tr>
        <tr class="border">
          <td class="border" rowspan="4">
          </td>
          <td class="border">
<span class="condition">
f0
<br>
g0
<br>
f1
<br>
g1
</span>
          </td>
          <td class="border">
振幅gainのfilter特性値
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="wF">f_vib</span>=0@default
<br>
<span class="run">Ver.1.56.11追加</span>
<br>
<span class="jF">Ver.1.56.12更新</span>
          </td>
          <td class="border">
f_vibrato[Hz]
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="wF">overtone</span>=0@default
<br>
<span class="run">Ver.1.64.14追加</span>
          </td>
          <td class="border">
基音より高周波数の倍音の整数倍上限値
          </td>
        </tr>
        <tr class="border">
          <td class="border">
ti=0@default
<br>
to=0@default
<br>
<span class="run">Ver.1.74.14追加</span>
<br>
<span class="clear">Ver.1.77.14更新</span>
          </td>
          <td class="border">
ti：in時間差[msec]
<br>
to：out時間差[msec]
<br>
・b使用可
<br>
・<a title="[test]play-buttons" href="../30_wave/buttons.html">[test]play-buttons</a>の場合、時間[sec]を指定
<br>
<br>
音階列挙の左からglissando
<br>
・script入力のみ
<br>
・各音階でduty/amplitude/rate可変
<br>
・各音階（overtoneを含む）で別途、fade-in/out処理を実施
<br>
　（p0/p1指定時間に対する直線近似処理）
<br>
・発音条件：(ti+to)×(音階の個数-1)＜時間
<br>
<span class="clear">・各音階gainの過小評価を改善（max係数の目安≒14.99　⇒　4.13）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
時間[msec]
          </td>
          <td class="border">
b
<br>
<span class="run">Ver.1.19.4追加</span>
          </td>
          <td class="border">
1beatの単位を表す中置の除算演算子
<br>
・演算後、60BPM基準1beat=1000msecを乗算
<br>
<br>
b = b1 = 1b = 1b1 = 2b2 = 4b4 = 1000
<br>
2b = 2b1 = 4b2 = 2000
<br>
4b = 4b1 = 8b2 = 4000
<br>
b2 = 1b2 = 2b4 = 500
<br>
b4 = 1b4 = 2b8 = 250
<br>
1.5b = 1.5b1 = 15e-1b1.0e+0 = 3b2 = 1500
          </td>
        </tr>
        <tr class="border">
          <td class="border">
周波数[Hz]
<br>
<span class="run">Ver.1.19.4更新</span>
          </td>
          <td class="border">
f
          </td>
          <td class="border">
frequency checker参照
<br>
<br>
<span class="run">小数点以下を有効化</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
音階
<br>
<span class="clear">Ver.1.13.4修正</span>
          </td>
          <td class="border">
o
<br>
c
<br>
n
<br>
f
          </td>
          <td class="border">
音階の記法参照
<br>
"o"+<span class="clear">MIDI-octave数-1~9</span>+"c"+<span class="clear">MIDI-相対note数0~11~</span>
<br>
"n"+<span class="clear">MIDI-絶対note数0~</span>
<br>
"f"+周波数
<br>
周波数
<br>
<br>
<span class="clear">MIDI-octave数の負数を有効化・範囲修正-2~8　⇒　-1~9</span>
<br>
過去の入力形式から変更する場合、octave数の降順に1加算して<a href="../71_regexp/index.html">正規表現text置換</a>の要修正
<br>
out=text.replace(/o8/gm,"o9");　⇒　out=text.replace(/o7/gm,"o8");　⇒　...
<br>
<br>
o4c9 = o3c21 = o2c33 = o1c45 = o0c57 <span class="clear">= o-1c69 = n69</span> <span class="run">= A4</span> = f440 = 440
<br>
o5c0 <span class="clear">= o-1c72 = n72</span> <span class="run">= C5</span> <span class="condition">= f523.25 = f5.2325e2</span> = 523.25 = 5.2325e2
          </td>
        </tr>
      </tbody>
    </table>
<br>
    <table class="border">
      <caption>音階の記法@octave=4</caption>
      <thead>
        <tr class="border">
          <th class="border">
<span class="clear">MIDI-相対note数</span>
          </th>
          <th class="border">
音階
          </th>
          <th class="border">
<span class="run">pitch記法（正順）</span>
<br>
<span class="run">Ver.1.15.4追加</span>
          </th>
          <th class="border">
oc記法（逆順）
<br>
<span class="clear">Ver.1.13.4修正</span>
          </th>
          <th class="border">
n記法
          </th>
          <th class="border">
f記法（f省略可）
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="border">
          <td class="border">
<span class="clear">00</span>
          </td>
          <td class="border">
C（ド）
          </td>
          <td class="border">
C4
          </td>
          <td class="border">
<span class="clear">o4</span>c0
<br>
<span class="clear">o4</span>c00
          </td>
          <td class="border">
n60
          </td>
          <td class="border">
f261.6255653005986
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">01</span>
          </td>
          <td class="border">
C＃/D♭
          </td>
          <td class="border">
C4s
<br>
D4f
          </td>
          <td class="border">
<span class="clear">o4</span>c01
          </td>
          <td class="border">
n61
          </td>
          <td class="border">
f277.1826309768721
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">02</span>
          </td>
          <td class="border">
D（レ）
          </td>
          <td class="border">
D4
          </td>
          <td class="border">
<span class="clear">o4</span>c02
          </td>
          <td class="border">
n62
          </td>
          <td class="border">
f293.6647679174076
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">03</span>
          </td>
          <td class="border">
D＃/E♭
          </td>
          <td class="border">
D4s
<br>
E4f
          </td>
          <td class="border">
<span class="clear">o4</span>c03
          </td>
          <td class="border">
n63
          </td>
          <td class="border">
f311.12698372208087
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">04</span>
          </td>
          <td class="border">
E（ミ）
          </td>
          <td class="border">
E4
          </td>
          <td class="border">
<span class="clear">o4</span>c04
          </td>
          <td class="border">
n64
          </td>
          <td class="border">
f329.6275569128699
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">05</span>
          </td>
          <td class="border">
F（ファ）
          </td>
          <td class="border">
F4
          </td>
          <td class="border">
<span class="clear">o4</span>c05
          </td>
          <td class="border">
n65
          </td>
          <td class="border">
f349.2282314330039
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">06</span>
          </td>
          <td class="border">
F＃/G♭
          </td>
          <td class="border">
F4s
<br>
G4f
          </td>
          <td class="border">
<span class="clear">o4</span>c06
          </td>
          <td class="border">
n66
          </td>
          <td class="border">
f369.99442271163446
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">07</span>
          </td>
          <td class="border">
G（ソ）
          </td>
          <td class="border">
G4
          </td>
          <td class="border">
<span class="clear">o4</span>c07
          </td>
          <td class="border">
n67
          </td>
          <td class="border">
f391.99543598174927
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">08</span>
          </td>
          <td class="border">
G＃/A♭
          </td>
          <td class="border">
G4s
<br>
A4f
          </td>
          <td class="border">
<span class="clear">o4</span>c08
          </td>
          <td class="border">
n68
          </td>
          <td class="border">
f415.3046975799451
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">09</span>
          </td>
          <td class="border">
A（ラ）
          </td>
          <td class="border">
A4
          </td>
          <td class="border">
<span class="clear">o4</span>c09
          </td>
          <td class="border">
n69
          </td>
          <td class="border">
f440
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">10</span>
          </td>
          <td class="border">
A＃/B♭
          </td>
          <td class="border">
A4s
<br>
B4f
          </td>
          <td class="border">
<span class="clear">o4</span>c10
          </td>
          <td class="border">
n70
          </td>
          <td class="border">
f466.1637615180899
          </td>
        </tr>
        <tr class="border">
          <td class="border">
<span class="clear">11</span>
          </td>
          <td class="border">
B（シ）
          </td>
          <td class="border">
B4
          </td>
          <td class="border">
<span class="clear">o4</span>c11
          </td>
          <td class="border">
n71
          </td>
          <td class="border">
f493.8833012561241
          </td>
        </tr>
      </tbody>
    </table>
<br>
    <table class="border">
      <caption>URL-parameter@browser上部URL入力欄</caption>
      <thead>
        <tr class="border">
          <th class="border">
項目
          </th>
          <th class="border">
内容
          </th>
          <th class="border">
実装
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="border">
          <td class="border">
testcase
<br>
<span class="run">Ver.1.27.4追加</span>
<br>
<span class="condition">Ver.1.33.6更新</span>
<br>
<span class="selection">Ver.1.38.8更新</span>
<br>
<span class="clear">Ver.1.44.11更新</span>
<br>
<span class="jF">Ver.1.52.11更新</span>
<br>
<span class="wF">Ver.1.65.14更新</span>
<br>
<span class="wF">Ver.1.67.14更新</span>
<br>
<span class="wF">Ver.1.68.14更新</span>
<br>
<span class="wF">Ver.1.76.14更新</span>
          </td>
          <td class="border">
test case
          </td>
          <td class="border">
0：1octaveのstereo出力（左右の差なし・Δf=0）
<br>
<span class="wF">duty0：1octaveの1ch出力（duty0=0・order_d=0.5）</span>
<br>
<span class="wF">duty1：1octaveの1ch出力（duty1=0・order_d=2）</span>
<br>
1：1octaveのstereo出力（左右の差あり・Δf=0）
<br>
Froschgesang：かえるの合唱（25秒・Δf=<span class="jF"><del>10</del>7.73...</span><span class="condition">・fade-inを有効化</span><span class="selection">・fade-outを有効化</span>）
<br>
Froschgesang100：かえるの合唱（100秒・Δf=<span class="jF"><del>10</del>7.73...</span><span class="condition">・fade-inを有効化</span><span class="selection">・fade-outを有効化</span>）
<br>
<span class="clear">・macro定義のspellを訂正：code　⇒　chord</span>
<br>
<span class="wF">Yuyake_Koyake：ja.wikipedia.org/wiki/夕焼小焼（作詞：中村雨紅／作曲：草川信）</span>
<br>
<span class="wF">Auld_Lang_Syne：ja.wikipedia.org/wiki/オールド・ラング・サイン（slur記号なしの楽譜）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
tVer
<br>
<span class="run">Ver.1.70.14追加</span>
          </td>
          <td class="border">
testcase-Ver
          </td>
          <td class="border">
tVer=1：script-Ver.1用のtestcaseを表示
<br>
それ以外：script-Ver.2用のtestcaseを表示
          </td>
        </tr>
      </tbody>
    </table>
<br>
    <table class="border">
      <caption>UI設定</caption>
      <thead>
        <tr class="border">
          <th class="border">
項目
          </th>
          <th class="border">
内容
          </th>
          <th class="border">
実装
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="border">
          <td class="border">
Byte数/sample
<br>
<span class="run">Ver.1.46.11追加</span>
<br>
<span class="selection">Ver.1.48.11追加</span>
          </td>
          <td class="border">
1sampleのByte数
          </td>
          <td class="border">
1：低音質
<br>
2：<del>高</del><span class="selection">中</span>音質
<br>
<span class="selection">3：高音質</span>
<br>
<span class="run">4：超高音質</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
sample数/sec
<br>
<span class="selection">Ver.1.50.11更新</span>
          </td>
          <td class="border">
1秒当たりのsample数
<br>
sampling rate
          </td>
          <td class="border">
44100：音楽
<br>
48000：映像
<br>
<br>
<span class="selection">samples_perSecond=8000~192000</span>
<br>
・音階の分解能：周波数[Hz]&lt;samples_perSecond/2
          </td>
        </tr>
        <tr class="border">
          <td class="border">
channel数
          </td>
          <td class="border">
出力のchannel数
          </td>
          <td class="border">
1：monaural
<br>
2：stereo
          </td>
        </tr>
        <tr class="border">
          <td class="border">
wave-type
<br>
<span class="condition">Ver.1.30.6修正</span>
<br>
<span class="run">Ver.1.34.6更新</span>
<br>
<span class="jF">Ver.1.71.14更新</span>
          </td>
          <td class="border">
波形の種類
          </td>
          <td class="border">
<span class="clear">dataset優先</span>
<br>
<br>
sin：正弦波
<br>
triangle：三角波
<br>
square：矩形波<span class="condition">（波形@f=0を修正）</span>
<br>
sawtooth：のこぎり波<span class="run">=-1~|／|</span><span class="condition">（波形@f=0を修正）</span>
<br>
<span class="run">sawtoothrev：逆のこぎり波=1~|＼|</span>
<br>
<span class="run">sawtooth0：のこぎり波=0~／|／</span>
<br>
<span class="run">sawtooth0rev：逆のこぎり波=0~＼|＼</span>
<br>
<span class="jF">sawsmooth：のこぎり波（より滑らか）=0~／|0~＼</span>
<br>
<br>
各type：datasetの位相初期値=0
<br>
<span class="run">各type_rand：datasetの位相初期値=[0,2π)の乱数</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
wave-duty
<br>
<span class="run">Ver.1.16.4追加</span>
          </td>
          <td class="border">
波形のduty比
          </td>
          <td class="border">
<span class="clear">dataset優先</span>
<br>
<br>
上ON/下ON時間の非対称性を定義
<br>
duty=0.5：上下対称
<br>
duty≠0.5：上下非対称・上下不連続（duty比を閾値に比例係数を2値化）
<br>
<br>
<span class="run">wave-type=square：duty可変のpulse波に対応</span>
<br>
<br>
詳細は<a title="Graphing Calculator" href="../02_calc_graphing/index.html">Graphing Calculator-test case-wave</a>参照
          </td>
        </tr>
        <tr class="border">
          <td class="border">
sweep-rate
<br>
<span class="run">Ver.1.24.4追加</span>
<br>
<span class="jF">Ver.1.56.12更新</span>
          </td>
          <td class="border">
出だし音の周波数sweep用
<br>
指定周波数基準rate
          </td>
          <td class="border">
<span class="clear">dataset優先</span>
<br>
<br>
rate=1：周波数のsweepなし（周波数を固定）
<br>
rate=0.5：指定時間で周波数を半減
<br>
rate=2：指定時間で周波数を倍増
<br>
rate&gt;&gt;1：sample数/sec&gt;&gt;10000（要分解能）
<br>
<span class="jF">・sweep中の位相の連続性を改善（dataset内で位相の前回値を継承）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
sweep-order
<br>
<span class="run">Ver.1.25.4追加</span>
          </td>
          <td class="border">
周波数sweepの次数
          </td>
          <td class="border">
<span class="clear">dataset優先</span>
<br>
<br>
order=1：線形に変化
<br>
order&lt;1：減速的に変化
<br>
order&gt;1：加速的に変化
<br>
order&gt;&gt;1：sample数/sec&gt;&gt;10000（要分解能）
          </td>
        </tr>
        <tr class="border">
          <td class="border">
f_vibrato[Hz]
<br>
<span class="condition">Ver.1.57.12追加</span>
          </td>
          <td class="border">
vibratoの周波数
          </td>
          <td class="border">
<span class="clear">dataset優先</span>
<br>
<br>
<span class="condition">vibratoを模擬</span>
<br>
・pitch変化のみを想定
<br>
・変化量の連続性を考慮
<br>
<span class="condition">・着信音の場合、10~15[Hz]</span>
<br>
<br>
omega_vib=2pi*f_vib
<br>
dkf_vib=(1-pow(2,1/12))/2　<span class="jF">半音の半値幅の振幅を仮定</span>
<br>
kdf=sin(omega_vib*t)*dkf_vib　<span class="jF">±両側の変動を仮定</span>
<br>
df=kdf*f
<br>
f=f+df
          </td>
        </tr>
        <tr class="border">
          <td class="border">
overtone
<br>
<span class="run">Ver.1.64.14追加</span>
<br>
<span class="jF">Ver.1.67.14更新</span>
<br>
<span class="condition">Ver.1.80.14更新</span>
          </td>
          <td class="border">
倍音の整数倍上限値
          </td>
          <td class="border">
<span class="clear">dataset優先</span>
<br>
<br>
基音より高周波数の倍音を自動付与
<br>
・overtone=0||1の場合、無効
<br>
・乱数なしの整数倍
<br>
・log-log filterを適用
<br>
・現状、script入力のみ、max係数が厳密
<br>
・単音/和音pageのamplitudeの内部limiterを解除
<br>
・単音/和音pageのmax係数の目安を改善<span class="jF">（gain和で単純換算のため、過小評価）
<br>
・倍音のgainを厳密化（音質の劣化を改善：max係数の目安≒7.15　⇒　6.15）</span>
<br>
<span class="condition">・各音階の自然なgain調整の演算を追加
<br>
・各音階の位相初期値を更新（mod 5-1の演算）</span>
<br>
　<span class="condition">音色：sawtooth　⇒　↑sin↓triangle</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
time[sec]
          </td>
          <td class="border">
出力時間の全長
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
tempo
<br>
<span class="run">Ver.1.17.4追加</span>
          </td>
          <td class="border">
時間の長さ
          </td>
          <td class="border">
datasetの時間に乗算
<br>
<br>
BPM=60/tempo
<br>
・60BPM基準1beat=1000msec
          </td>
        </tr>
        <tr class="border">
          <td class="border">
pitch
<br>
<span class="run">Ver.1.17.4追加</span>
          </td>
          <td class="border">
音の高さ
          </td>
          <td class="border">
datasetの周波数に乗算
<br>
<br>
音の媒体：空気の圧力変動を可視化する場合、<a title="Incompressible flow" href="../10_fluid/index.html?sim=fluid&nmax=1000&testcase=5">Incompressible flow</a>参照
          </td>
        </tr>
        <tr class="border">
          <td class="border">
amplitude
<br>
<span class="run">Ver.1.17.4追加</span>
<br>
<span class="selection">Ver.1.28.4更新</span>
<br>
<span class="condition">Ver.1.35.6更新</span>
<br>
<span class="clear">Ver.1.40.9修正</span>
<br>
<span class="jF">Ver.1.45.11追加</span>
<br>
<span class="wF">Ver.1.75.14修正</span>
          </td>
          <td class="border">
音の大きさ
          </td>
          <td class="border">
<del><span class="clear">dataset優先</span></del>
<br>
<span class="selection">datasetの振幅に乗算</span>
<br>
<span class="wF">・kampliとamplitude0/amplitude1：従属　⇒　独立</span>
<br>
<br>
<span class="condition">script入力のみ、振幅の上限解放
<br>
・int値over-flowの場合、<del>pulse波のnoise発生</del></span><span class="clear">post処理でerror終了に修正</span>
<br>
・<span class="clear">Ver.1.41.10</span>以降、stream処理も同様に、error終了に修正
<br>
・WebWorkers準備中にerror終了の場合、Uncaught NetworkErrorが発生
<br>
<br>
<span class="condition">play実行後、amplitude上限値（max係数）の目安を表示</span>
<br>
・datasetの振幅不変の前提でint値の余裕から推定
<br>
・乱数で多少の変動あり
<br>
<span class="clear">・post処理でint値over-flowの場合、overflowを表示</span>
<br>
・単音||和音の場合、max係数のfeedforward入力値で内部制限あり
<br>
<br>
<span class="jF">auto-maxのcheckboxを追加</span>
<br>
・post処理で振幅を最大化する自動scaling（scale比大で波形の劣化あり）
<br>
・scale比=max係数/入力値（scale比=1で波形の劣化なし）
<br>
・scale比はint値範囲内の安全側に丸める（scale比=1を除く）
<br>
・scale比=1の場合、＝max係数を表示
<br>
・scale比&gt;1の場合、≒floor(max係数の小数点2桁以上)の目安を表示
<br>
・演奏の場合、全波形の合成後、max係数が決まるため、feedback入力の方が確実
          </td>
        </tr>
        <tr class="border">
          <td class="border">
Δf
<br>
<span class="run">Ver.1.29.4追加</span>
<br>
<span class="selection">Ver.1.32.6更新</span>
<br>
<span class="condition">Ver.1.33.6更新</span>
<br>
<span class="jF">Ver.1.52.11更新</span>
          </td>
          <td class="border">
stereo効果のゆらぎ周波数[Hz]
          </td>
          <td class="border">
<del><span class="clear">stereo出力限定</span></del>
<br>
post最終処理
<br>
<span class="selection">・monaural出力の場合、stereo出力<span class="condition">@s_stereo=100</span>のchannel1のみを出力</span>
<br>
<br>
Δf=0：channel間の合成なし（左右を完全分離）
<br>
|Δf|&gt;0：channel間の合成あり（左右をゆらぎ周波数で合成）
<br>
<span class="condition">|Δf|&lt;&lt;0.001：channel間を平滑化（s_stereo=100の場合、左右を同一化）</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
↑s_random
<br>
<span class="run">Ver.1.32.6追加</span>
          </td>
          <td class="border">
Δfのばらつき強度
          </td>
          <td class="border">
Δfのばらつき範囲：Δf*pow(2,s_random*[-1,1))
<br>
<br>
s_random=0：ばらつきなし（ゆらぎが一様）
<br>
s_random≠0：ばらつきあり（play実行毎に異なる乱数を生成）
          </td>
        </tr>
        <tr class="border">
          <td class="border">
↑s_stereo
<br>
<span class="run">Ver.1.33.6追加</span>
<br>
<span class="condition">Ver.1.37.8修正</span>
          </td>
          <td class="border">
左右で振動する音量の調整用
<br>
Δfの他channel合成率[%]
<br>
Δfの振幅強度[%]
          </td>
          <td class="border">
<span class="clear">stereo出力限定</span>
<br>
・monaural出力の場合、左右の振動なし
<br>
<br>
s_stereo&gt;0：他channelの合成あり
<br>
s_stereo=0：他channelの合成なし（左右を完全分離）
<br>
s_stereo=100：左右均等の重みで合成
<br>
<br>
<span class="condition">重み平均：<del>newVal0 = (1-s)*val0+s*val1</del>　⇒　newVal0 = s*val0+(1-s)*val1</span>
<br>
・s=0.5@s_stereo=100
<br>
・s=1@s_stereo=0
          </td>
        </tr>
        <tr class="border">
          <td class="border">
volume[%]
          </td>
          <td class="border">
play時の音量
          </td>
          <td class="border">
play機能のみ有効
          </td>
        </tr>
        <tr class="border">
          <td class="border">
play
          </td>
          <td class="border">
encodeの実行button
          </td>
          <td class="border">
正常終了時
<br>
・soundを再生
<br>
・downloadの準備完了
          </td>
        </tr>
        <tr class="border">
          <td class="border">
stop
          </td>
          <td class="border">
playの中断button
          </td>
          <td class="border">
Multi-threadのみ中断可
          </td>
        </tr>
        <tr class="border">
          <td class="border">
random
<br>
<span class="run">Ver.1.61.13追加</span>
          </td>
          <td class="border">
test caseの生成button
          </td>
          <td class="border">
設定項目
<br>
・datasetの個数=0~
<br>
・休止状態の遷移確率=0~1
<br>
・音階初期状態の遷移確率=0~1
<br>
・変化量の前回値の重み=0~1
          </td>
        </tr>
        <tr class="border">
          <td class="border">
log
          </td>
          <td class="border">
実行結果のlog
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
file size[<span class="clear">M</span>B]
<br>
<span class="clear">Ver.1.30.5修正</span>
          </td>
          <td class="border">
保存file size
          </td>
          <td class="border">
<span class="clear">file size制限の条件を追加</span>
<br>
・dataset毎の制限
<br>
<span class="clear">・全datasetの制限（演奏用）</span>
<br>
<br>
limit：<span class="clear">1GB</span>=1024MB=1024^2KB=1024^3B=1073741824B
          </td>
        </tr>
        <tr class="border">
          <td class="border">
link
          </td>
          <td class="border">
download link
          </td>
          <td class="border">
browserでencodeされたbinaryをlocalに保存（通信なし）
          </td>
        </tr>
        <tr class="border">
          <td class="border">
file name
<br>
<span class="run">Ver.1.68.14更新</span>
          </td>
          <td class="border">
保存file name
          </td>
          <td class="border">
<span class="run"><del>任意名の入力機能の実装は保留</del>
<br>
任意名を入力可
<br>
・半角相当の文字数制限：50文字（拡張子を<del>含む</del>除く）
<br>
・auto checked時、後方互換性あり
<br>
・固有名詞を含むtestcaseの場合、auto非表示
</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
option
<br>
<span class="run">Ver.1.13.2更新</span>
          </td>
          <td class="border">
encodeのoption
          </td>
          <td class="border">
Multi-threadの選択可<span class="run">（並列化に対応）
<br>
N：並列化のthread数</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
amplitude-fade
<br>
<span class="clear">Ver.1.13.3追加</span>
<br>
<span class="run">Ver.1.38.8更新</span>
<br>
<span class="condition">Ver.1.39.8更新</span>
<br>
<span class="selection">Ver.1.40.8変更</span>
<br>
<span class="wF">Ver.1.49.11追加</span>
          </td>
          <td class="border">
dataset内click noise対策用
<br>
振幅fade-in/outのfilter特性値
          </td>
          <td class="border">
stream処理
<br>
<br>
w0：in-weight
<br>
p0：in-range
<br>
w1：out-weight
<br>
p1：out-range
<br>
・in：datasetの最初sampleから
<br>
・out：datasetの最後sampleまで
<br>
・range：<span class="selection">fade_oder&ge;0既定の場合、時間[sec]</span>
<br>
　<span class="selection">fade_oder&lt;0の場合、datasetの全sample数に対する割合</span>
<br>
・rangeの区間：tempoと独立（生のfade区間）
<br>
・rangeの重複箇所：in優先
<br>
　<span class="run">残りをout-rangeに更新（曲線近似の正規化対策）</span>
<br>
<span class="run">・fade有効化の条件：p0 &gt; 0 || p1 &gt; 0</span>
<br>
<br>
1次遅れ系のstep応答：S字の変曲点なし
<br>
・fade-in：振幅=上限値まで上凸の変化
<br>
・fade-out：振幅=0まで下凸の変化
<br>
・fade処理後、script入力のamplitudeの比例係数を乗算
<br>
<del>・高負荷のS字（sigmoid）曲線近似の検討は保留</del>
<br>
<br>
<span class="condition">1次遅れ系の曲線近似（べき乗）を追加</span>
<br>
・w0/w1：時定数を可変
<br>
・w=0：時間の0.5乗（上凸の変化）
<br>
・w=0.5：時間の1乗（線形変化の直線近似）
<br>
・w=1：時間の2乗（下凸の変化）
<br>
<br>
<span class="run">2次遅れ系の曲線近似（sigmoid）を追加</span>
<br>
・w0/w1：変曲点位置を可変
<br>
・w=0.5：上下対称
<br>
・w&lt;0.5：下に移動
<br>
・w&gt;0.5：上に移動
<br>
<br>
<span class="wF">2次遅れ系の曲線近似（cos）を追加</span>
<br>
・w0/w1：無効
          </td>
        </tr>
        <tr class="border">
          <td class="border">
fade-order
<br>
<span class="run">Ver.1.38.8追加</span>
<br>
<span class="condition">Ver.1.39.8更新</span>
<br>
<span class="selection">Ver.1.40.8変更</span>
<br>
<span class="wF">Ver.1.49.11追加</span>
          </td>
          <td class="border">
filter遅れの次数
          </td>
          <td class="border">
<span class="condition">order_fade=0||1.</span>：1次遅れ系（<span class="selection">p0/p1指定時間の区間で</span>重み平均の逐次処理）
<br>
<span class="condition">order_fade=1：1次遅れ系（<span class="selection">p0/p1指定</span>時間に対する曲線近似処理）</span>
<br>
<span class="run">order_fade=2：2次遅れ系（<span class="selection">p0/p1指定</span>時間に対する曲線近似処理）</span>
<br>
<span class="wF">order_fade=3：2次遅れ系（<span class="selection">p0/p1指定</span>時間に対する曲線近似処理）</span>
<br>
<span class="selection">order_fade=-1||old1：1次遅れ系（p0/p1割合sampleの時間に対する曲線近似処理）</span>
<br>
<span class="selection">order_fade=-2||old2：2次遅れ系（p0/p1割合sampleの時間に対する曲線近似処理）</span>
<br>
・逐次処理の場合、model parameterがsampling rateに依存（調整困難）
<br>
・低負荷の直線||<span class="wF">cos</span>近似で十分の可能性あり
<br>
<br>
詳細は<a title="Graphing Calculator" href="../02_calc_graphing/index.html">Graphing Calculator-test case-fade</a>参照
          </td>
        </tr>
        <tr class="border">
          <td class="border">
raw-value fade
<br>
<span class="run">Ver.1.4.2追加</span>
<br>
<span class="clear">Ver.1.13.3削除</span>
<br>
<span class="run">Ver.1.18.4復帰</span>
<br>
<span class="condition">Ver.1.66.14更新</span>
          </td>
          <td class="border">
dataset間click noise対策用
<br>
1次遅れ系
<br>
生値fade-in/outのfilter特性値
          </td>
          <td class="border">
post処理
<br>
<br>
old-weight：前回値の重み
<br>
<span class="condition">・default：0.005　⇒　0</span>
<br>
<br>
重み平均：newVal = w*oldVal+(1-w)*nowVal
          </td>
        </tr>
        <tr class="border">
          <td class="border">
log-log filter gain
          </td>
          <td class="border">
出力調整用
<br>
振幅gainのfilter特性値
          </td>
          <td class="border">
stream処理
<br>
<br>
f0：low側の周波数
<br>
g0：low側のgain
<br>
f1：high側の周波数
<br>
g1：high側のgain
<br>
<br>
既定値：聴き取りやすい高周波数の出力を意図的に低下（LPF想定）
<br>
・hardwareからの最終出力：speakerの周波数特性のgainを乗算（可聴域外のgain≒0）
<br>
<br>
補足：振幅のRMS統一で波形間の比較
<br>
・Fourier変換で高周波数成分を含む波形（sin以外）の方が聴き取りやすい
<br>
<a title="Graphing Calculator" href="../02_calc_graphing/index.html">Graphing Calculator-test case-Fourier</a>参照
          </td>
        </tr>
        <tr class="border">
          <td class="border">
frequency checker
<br>
<span class="run">Ver.1.14.4追加</span>
          </td>
          <td class="border">
周波数checker
          </td>
          <td class="border">
MIDI-octave：octave数
<br>
MIDI-note：note数
<br>
frequency[Hz]：frequency(octave,note)
<br>
<br>
<a title="Graphing Calculator" href="../02_calc_graphing/index.html">Graphing Calculator-test case-MIDI</a>参照
<br>
<span class="selection">frequency(octave,note)=&lt;last{m=(octave+1)*12+note,pow(2,(m-<span class="clear">69</span>)/12)*440};</span>
<br>
<span class="selection">frequency(4,9) -> 440</span>
<br>
<span class="selection">frequency(-1,<span class="clear">69</span>) -> 440</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
script
          </td>
          <td class="border">
script入力欄
          </td>
          <td class="border">
入力textは半角のみ有効
          </td>
        </tr>
        <tr class="border">
          <td class="border">
original script
<br>
<span class="run">Ver.1.41.9追加</span>
<br>
<span class="clear">Ver.1.42.10更新</span>
          </td>
          <td class="border">
text置換結果の確認用
<br>
original script出力欄
          </td>
          <td class="border">
macro機能のtext置換後のscriptを出力
<br>
<span class="clear">・macro残存の場合、error終了</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
script-Ver
<br>
<span class="run">Ver.1.70.14追加</span>
          </td>
          <td class="border">
script仕様
          </td>
          <td class="border">
基本dataset:通常formatの仕様
<br>
・script-Ver.1：直前datasetの拡張設定値を継承（後方互換性を担保）
<br>
・script-Ver.2：dataset内のみ拡張設定値が有効
          </td>
        </tr>
      </tbody>
    </table>
<br>
    <table class="border">
      <caption>error終了の発生条件</caption>
      <thead>
        <tr class="border">
          <th class="border">
事象
          </th>
          <th class="border">
発生条件
          </th>
          <th class="border">
対策
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="border">
          <td class="border">
予期せぬerror@演奏のplay実行時
<br>
{1:A4} -> Uncaught NetworkError: ...
          </td>
          <td class="border">
time極短のMulti-thread encode
<br>
・total time &lt;&lt; 1000msec
<br>
・parallel N &gt; 1
          </td>
          <td class="border">
Single-thread encode
<br>
・再現性なし
<br>
・download機能に問題なし
          </td>
        </tr>
        <tr class="border">
          <td class="border">
再生中断@演奏のplay実行中
          </td>
          <td class="border">
不明
          </td>
          <td class="border">
stop後、re-play
<br>
・再現性なし
<br>
・download機能に問題なし
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</body>

</html>
