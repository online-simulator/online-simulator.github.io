<!DOCTYPE html>

<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta name="description" content="[spec]筆penの設定">
  <meta name="author" content="online-simulator.github.io">
  <noscript>JavaScript is not enabled on browser.</noscript>
  <link rel="stylesheet" type="text/css" href="../00_common/css/common.css">
  <link rel="stylesheet" type="text/css" href="../00_common/css/color.css">
  <link rel="stylesheet" type="text/css" href="../00_common/css/size.css">
  <link rel="stylesheet" type="text/css" href="css/common.css">
  <link rel="stylesheet" type="text/css" href="css/color.css">
  <link rel="stylesheet" type="text/css" href="css/size.css">
</head>

<body>
  <div class="absolute">
    <table class="border">
      <caption>筆penの設定</caption>
      <thead>
        <tr class="border">
          <th class="border">
項目
          </th>
          <th class="border">
内容
          </th>
          <th class="border">
実装
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="border">
          <td class="border">
w=0~W[px]
          </td>
          <td class="border">
line幅
          </td>
          <td class="border">
w可変の従属parameterを選択可
<br>
・w=w(f)=w(p)
<br>
・w=w(f)=w(len)
          </td>
        </tr>
        <tr class="border">
          <td class="border">
p=0~1
          </td>
          <td class="border">
筆圧
          </td>
          <td class="border">
p=p(f)
          </td>
        </tr>
        <tr class="border">
          <td class="border">
len=0~[px]
          </td>
          <td class="border">
筆中心の移動量
          </td>
          <td class="border">
len=len(f)=|dxy(f)|
          </td>
        </tr>
        <tr class="border">
          <td class="border">
xy={x,y}
          </td>
          <td class="border">
筆中心のcanvas座標
          </td>
          <td class="border">
列vector
<br>
xy=xy(f)={x(f),y(f)}
<br>
dxy(f)=xy(f)-xy(f-1)={dx(f),dy(f)}
          </td>
        </tr>
        <tr class="border">
          <td class="border">
line(f)
          </td>
          <td class="border">
frame間の筆中心line
          </td>
          <td class="border">
line上線分の2点
<br>
xy(f-1)
<br>
xy(f)
          </td>
        </tr>
        <tr class="border">
          <td class="border">
vline(f)
          </td>
          <td class="border">
筆中心lineの垂線
          </td>
          <td class="border">
vline上線分の2点
<br>
xym(f)=xy(f)-rdxyk(f)
<br>
xyp(f)=xy(f)+rdxyk(f)
<br>
<br>
rot=(0,1:-1,0)
<br>
k=(w(f)/2)/len
<br>
rdxyk(f)=rot*dxy(f)*k={dy(f),-dx(f)}*k
          </td>
        </tr>
        <tr class="border">
          <td class="border">
tetragon(f)
          </td>
          <td class="border">
2vlineの四辺形
          </td>
          <td class="border">
四辺形の2辺
<br>
vline(f-1)
<br>
vline(f)
          </td>
        </tr>
        <tr class="border">
          <td class="border">
f=0~
          </td>
          <td class="border">
move検知frame回数
          </td>
          <td class="border">
down検知で初期化f=0
          </td>
        </tr>
        <tr class="border">
          <td class="border">
rgba
          </td>
          <td class="border">
pixelのRGBA
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border selection">
          <td class="border">
URLの設定例
          </td>
          <td class="border">
index.html?
<br>
pressure=true&amp;
<br>
W=20&amp;
<br>
RGB=orange&amp;
<br>
bg=pink&amp;
<br>
canvas-width=200&amp;
<br>
ox=-20&amp;
<br>
oy=-20
          </td>
          <td class="border">
#を使用するHEX形式の色指定不可
<br>
以降のUIよりURLの設定値を優先
          </td>
        </tr>
        <tr class="border">
          <td class="border">
pressure=false||true
          </td>
          <td class="border">
筆圧入力の有効化
          </td>
          <td class="border">
w(p)=W*p(f)
<br>
・対応環境p(f)=e.pressure
<br>
・非対応環境p(f)=0.5
          </td>
        </tr>
        <tr class="border">
          <td class="border">
black=false||true
          </td>
          <td class="border">
page背景色の黒色化
          </td>
          <td class="border">
canvas描画に影響なし
          </td>
        </tr>
        <tr class="border">
          <td class="border">
W=0~[px]
          </td>
          <td class="border">
line幅の最大値
          </td>
          <td class="border">
0&le;w(f)&le;W
          </td>
        </tr>
        <tr class="border">
          <td class="border">
RGB=#000000~#ffffff
          </td>
          <td class="border">
lineの基本色RGB
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
A=<span class="run">-100</span>~100[%]
<br>
<span class="run">Ver.1.6.1追加</span>
          </td>
          <td class="border">
lineの不透明度A
          </td>
          <td class="border">
<span class="run">
A&lt;0
<br>
r+g+b+a&gt;0
<br>
a=min(a, |A|)
<br>
a&le;|A|
<br>
<del>png/svgの整合性なし（履歴を含む）</del>
<br>
Ver.1.7.1以降、整合性を確保
</span>
<br>
<span class="clear">
Ver.1.6.1互換機能を追加
</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
bg
          </td>
          <td class="border">
canvas背景色
          </td>
          <td class="border">
canvas描画に影響あり
          </td>
        </tr>
        <tr class="border">
          <td class="border">
canvas-width=16~1280[px]
          </td>
          <td class="border">
canvas幅
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
canvas-height=16~1280[px]
          </td>
          <td class="border">
canvas高さ
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
cap=butt||round||square
          </td>
          <td class="border">
line端の形状
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
composite
          </td>
          <td class="border">
lineのRGBA合成方法
          </td>
          <td class="border">
同期処理（shadow描画を除く）
<br>
・canvas前面にlineを逐次合成
<br>
<br>
<span class="run">
Ver.1.7.1以降、非同期処理を追加
<br>
・up検知で1筆のlinesを
<br>
　canvas前面から背面に合成
<br>
</span>
          </td>
        </tr>
        <tr class="border">
          <td class="border">
ox[px]
          </td>
          <td class="border">
筆中心のx方向offset
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
oy[px]
          </td>
          <td class="border">
筆中心のy方向offset
          </td>
          <td class="border">
          </td>
        </tr>
        <tr class="border">
          <td class="border">
w_th=0~[px]
<br>
<span class="run">Ver.1.4.1追加</span>
          </td>
          <td class="border">
1frame内
<br>
w可変のw閾値
          </td>
          <td class="border">
w(f-1)+w(f)&gt;0
<br>
(min(w(f-1),w(f))&lt;w_th)?
<br>
fill(tetragon):
<br>
stroke(line)
          </td>
        </tr>
        <tr class="border">
          <td class="border">
len_th=0~[px]
          </td>
          <td class="border">
frame間
<br>
w可変のlen閾値
          </td>
          <td class="border">
dlen(f)=len(f)-len_th
<br>
w(f)=w(f-1)+dw(dlen)
          </td>
        </tr>
        <tr class="border">
          <td class="border">
in
          </td>
          <td class="border">
fade-in強度
          </td>
          <td class="border">
dlen&lt;0
<br>
dw(dlen) = (in&lt;0)? dlen*in: in;
          </td>
        </tr>
        <tr class="border">
          <td class="border">
out
          </td>
          <td class="border">
fade-out強度
          </td>
          <td class="border">
dlen&gt;0
<br>
dw(dlen) = (out&lt;0)? dlen*out: -out;
          </td>
        </tr>
        <tr class="border">
          <td class="border">
sh=0~
          </td>
          <td class="border">
shadowのぼかし強度
          </td>
          <td class="border">
svg出力
<br>
・filter効果範囲のclip対策
          </td>
        </tr>
        <tr class="border">
          <td class="border">
png後処理
<br>
RGB=-1~255
<br>
A=-1~100[%]
<br>
<span class="run">Ver.1.7.1追加</span>
          </td>
          <td class="border">
<span class="clear">
Ver.1.6.1互換機能
<br>
・RGBA各指定値に平滑化
<br>
・指定値&lt;0の要素は無効
</span>
          </td>
          <td class="border">
flat_low: 指定値の下側
<br>
flat_all: 指定値の両側（2値化）
<br>
flat_upp: 指定値の上側
          </td>
        </tr>
        <tr class="border">
          <td class="border">
png前処理
<br>
bg-image-file
<br>
<span class="run">Ver.1.8.1追加</span>
          </td>
          <td class="border">
local fileのread機能
          </td>
          <td class="border">
read完了後、canvas背面に合成
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</body>

</html>
